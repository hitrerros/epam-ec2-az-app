<html lang="">
<head>
    <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
</head>

<style>
    .custom-header {
        background: linear-gradient(135deg, #6f42c1, #6610f2);
        color: white;
        padding: 1rem 1rem;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        border-radius: 0 0 1rem 1rem;
    }

</style>


<body>
<header class="custom-header">
    <h4 class="display-6 fw-bold mb-2">AWS Student's App Management console</h4>
    <p class="lead">Created by Anton Khitrov</p>
</header>

<main class="container mt-5">
    <h4 class="mb-4">Available Options</h4>

    <!-- Subscribe Section -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h5 class="card-title">Subscribe to the Mailing List</h5>
            <form id="subscribeForm" class="row g-3" action="/queues/subscribe">
                <div class="col-md-9">
                    <label>
                        <input type="email" name="mail" id="subscribeEmail" class="form-control" placeholder="Enter your email" required>
                    </label>
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-primary w-100">Subscribe</button>
                </div>
            </form>
            <div id="subscribeMessage" class="mt-3"></div>
        </div>
    </div>

    <!-- Unsubscribe Section -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h5 class="card-title">Unsubscribe from the Mailing List</h5>
            <form id="unsubscribeForm" class="row g-3" action="/queues/unsubscribe">
                <div class="col-md-9">
                    <label>
                        <input type="email" id="unsubscribeEmail" name="mail" class="form-control" placeholder="Enter your email" required>
                    </label>
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-danger w-100">Unsubscribe</button>
                </div>
            </form>
            <div id="unsubscribeMessage" class="mt-3"></div>
        </div>
    </div>

    <!-- Upload Section -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h5 class="card-title">Upload File for Further Processing</h5>
            <form>
                <div class="mb-3">
                    <input class="form-control" type="file" required>
                </div>
                <button type="submit" class="btn btn-success">Upload</button>
            </form>
        </div>
    </div>
</main>

<script>
    function handleEmailFormSubmit({ formId, inputId, messageId, endpoint }) {
        const form = document.getElementById(formId);
        if (!form) return;

        form.addEventListener("submit", function (e) {
            e.preventDefault();

            const email = document.getElementById(inputId).value;
            const messageDiv = document.getElementById(messageId);

            fetch(`${endpoint}?mail=${encodeURIComponent(email)}`, {
                method: "GET"
            })
                .then(response => response.text())
                .then(data => {
                    messageDiv.innerHTML = `<pre class="bg-light p-3 rounded border"><code>${data}</code></pre>`;
                })
                .catch(error => {
                    messageDiv.innerHTML = `<pre class="bg-light p-3 rounded border text-danger"><code>An error occurred.</code></pre>`;
                });
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
        handleEmailFormSubmit({
            formId: "subscribeForm",
            inputId: "subscribeEmail",
            messageId: "subscribeMessage",
            endpoint: "/queues/subscribe"
        });

        handleEmailFormSubmit({
            formId: "unsubscribeForm",
            inputId: "unsubscribeEmail",
            messageId: "unsubscribeMessage",
            endpoint: "/queues/unsubscribe"
        });
    });

</script>

</body>
</html>